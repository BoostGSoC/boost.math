//  (C) Copyright John Maddock 2006.
//  Use, modification and distribution are subject to the
//  Boost Software License, Version 1.0. (See accompanying file
//  LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)

#define BOOST_TEST_MAIN

#include <boost/test/included/unit_test.hpp> // Boost.Test
#include <boost/test/unit_test.hpp>
#include <boost/math/concepts/real_concept.hpp>
#include "polygamma.hpp"
#include <boost/multiprecision/mpfr.hpp>

#define SC_(x) BOOST_STRINGIZE(x)

template <class T>
void test()
{
   static const char* data[] =
   {
       /* From 1 to 50 inclusive: */
      /* N[Table[polygamma(1,x),{x,1,50,1}],200] */
      SC_( 1.6449340668482264364724151666460251892189499012067984377355582293700074704032008738336289006197587053040043189623371906796287246870050077879351029463308662768317333093677626050952510068721400547968116),
      SC_( 0.64493406684822643647241516664602518921894990120679843773555822937000747040320087383362890061975870530400431896233719067962872468700500778793510294633086627683173330936776260509525100687214005479681156),
      SC_( 0.39493406684822643647241516664602518921894990120679843773555822937000747040320087383362890061975870530400431896233719067962872468700500778793510294633086627683173330936776260509525100687214005479681156),
      SC_( 0.28382295573711532536130405553491407810783879009568732662444711825889635929208976272251778950864759419289320785122607956851761357589389667682399183521975516572062219825665149398413989576102894368570045),
      SC_( 0.22132295573711532536130405553491407810783879009568732662444711825889635929208976272251778950864759419289320785122607956851761357589389667682399183521975516572062219825665149398413989576102894368570045),
      SC_( 0.18132295573711532536130405553491407810783879009568732662444711825889635929208976272251778950864759419289320785122607956851761357589389667682399183521975516572062219825665149398413989576102894368570045),
      SC_( 0.15354517795933754758352627775713630033006101231790954884666934048111858151431198494474001173086981641511543007344830179073983579811611889904621405744197738794284442047887371620636211798325116590792267),
      SC_( 0.13313701469403142513454668592040160645250999190974628354054689150152674477961810739371960356760451029266645048161156709686228477770795563374009160846238555120815054292785330804309681186080218631608594),
      SC_( 0.11751201469403142513454668592040160645250999190974628354054689150152674477961810739371960356760451029266645048161156709686228477770795563374009160846238555120815054292785330804309681186080218631608594),
      SC_( 0.10516633568168574612220100690805592744016431289740060452820121248918106576727242838137392455525883128032077146926588808451660576536227662139441259611670653886247153058217429569741779951512317397040692),
      SC_( 0.095166335681685746122201006908055927440164312897400604528201212489181065767272428381373924555258831280320771469265888084516605765362276621394412596116706538862471530582174295697417799515123173970406923),
      SC_( 0.086901872871768390750300180461774935704627122814755976429027658770172801304462511026002023728812550288585234279183243456417432211643268356931602678761334638036025249590438758507335154887024000416687915),
      SC_( 0.079957428427323946305855736017330491260182678370311531984583214325728356860018066581557579284368105844140789834738799011972987767198823912487158234316890193591580805145994314062890710442579555972243470),
      SC_( 0.074040268664010336838400114715555343331188595530074845594050669947030132007947060664397815970758638388519488059590870017890147530512433379942779536092038122585663645382680704595435089140804408043249387),
      SC_( 0.068938227847683806226155216756371669861800840428034029267520057702132172824273591276642713929942311857907243161631686344420759775410392563616248923847140163401990175994925602554618762610192163145290204),
      SC_( 0.064493783403239361781710772311927225417356395983589584823075613257687728379829146832198269485497867413462798717187241899976315330965948119171804479402695718957545731550481158110174318165747718700845759),
      SC_( 0.060587533403239361781710772311927225417356395983589584823075613257687728379829146832198269485497867413462798717187241899976315330965948119171804479402695718957545731550481158110174318165747718700845759),
      SC_( 0.057127325790782614376866481654487779050574389063174359909580803569106413500936413268184428655048040423843421554557484114509187303284287219517825240648370459441974797294425794788375010207270210050326728),
      SC_( 0.054040906037696194623780061901401359297487969310087940156494383816019993747849993515098008901961620670757001801471064361422767550197867466431405487561950706355555044208006041701955257120850456963906975),
      SC_( 0.051270822935203119831536294588381968715770517786542233785303248081947971587185173570499670951823116515632348061858875995771798021111994890254120169002393919651953936174765044472038359613925249207674288),
      SC_( 0.048770822935203119831536294588381968715770517786542233785303248081947971587185173570499670951823116515632348061858875995771798021111994890254120169002393919651953936174765044472038359613925249207674288),
      SC_( 0.046503249239057995114983006606522558284931515518968537640178531528659989727774742731497403378126971390915794773877016585340959018844421194108995452449105937792543505335762776898342214489208695919692429),
      SC_( 0.044437133536578656272007799994952310351047217998307380615385143098907923612072263392654428171515401142981910476356355428316165630414669127993292973110262962585931935087828892600821553332183902531262677),
      SC_( 0.042546774368336690298472828350339833980536821022882049802530700754862554992034456209289588852044701710089660948946147488807659014157580281112385600709506818918635148698414903942976562783979743741092544),
      SC_( 0.040810663257225579187361717239228722869425709911770938691419589643751443880923345098178477740933590598978549837835036377696547903046469170001274489598395707807524037587303792831865451672868632629981433),
      SC_( 0.039210663257225579187361717239228722869425709911770938691419589643751443880923345098178477740933590598978549837835036377696547903046469170001274489598395707807524037587303792831865451672868632629981433),
      SC_( 0.037731373316397176820497811913784935887177189201711767093786453549076887667905593618888536912531223735073224394048054129175837843874871536865179815042182690056044747646475390465001546347424845647732912),
      SC_( 0.036359631203914323596903847579079860441361002644784469425748044769927367777644962617516794800048370511479260059342978683359651286947573868826771035892662799795413746274733277982148322753460510942657467),
      SC_( 0.035084120999832690943842623089283942074014063869274265344115391708702877981726595270578019289844288878826198834853182764992304348172063664745138382831438309999495378927794502471944241120807449718167671),
      SC_( 0.033895060357739944213759388844337449802908237472128010885137983860902640169598176721232002642995299580371977669573753514100508866602503617182712699121569106670125581068103658238888355270629090621853759),
      SC_( 0.032783949246628833102648277733226338691797126361016899774026872749791529058487065610120891531884188469260866558462642402989397755491392506071601588010457995559014469956992547127777244159517979510742648),
      SC_( 0.031743366520302090126581680438741427141328864134169865434796903967273318860776347608039726079230702517127671969492819302052873301797323827611664022974037600137578465794661641820805339893128801571096446),
      SC_( 0.030766804020302090126581680438741427141328864134169865434796903967273318860776347608039726079230702517127671969492819302052873301797323827611664022974037600137578465794661641820805339893128801571096446),
      SC_( 0.029848530374755717307481588611376872504046954124987128979333175776272400587130801235220625987403337962490390059483636565597409573606322909338018476601218500045751101240024359910796157156673337842905445),
      SC_( 0.028983478471641530456270515947017010912351452394883322750959473354127071867407617844217165779790881215085545768826197119230627566685907684424523666912637185166858367676010519080346330167053960680275687),
      SC_( 0.028167151941029285558311332273547623157249411578556792138714575394943398398019862742176349453260268970187586585152727731475525525869581153812278768953453511697470612573969702753815717922156001496602218),
      SC_( 0.027395547002757680620039727335276018218977806640285187200442970456671793459748257803904744514988664031915981646881122793203920587597976215540673830681848573425865674302364764482210779650551063224997279),
      SC_( 0.026665086812838031240930888766977990461490589693608781064577375131617008945504284100471581622366311950104440375880392333014000938218867376972375802924361356479189268166499169157155995136307089521564116),
      SC_( 0.025972566037214762542869946938723142816061226812722354471779591198099003405338079114321997134831685911323276940977345241601258555947399232928054473284472159803288991158188919849676770759575787582505945),
      SC_( 0.025315103841291028157597100127414793046172995386029389317275975156021422866219078456859801211097300638476465632627575353369831862982244729312012395703933040802631528962265185464403923948267437812617713),
      SC_( 0.024690103841291028157597100127414793046172995386029389317275975156021422866219078456859801211097300638476465632627575353369831862982244729312012395703933040802631528962265185464403923948267437812617713),
      SC_( 0.024095219843670564148078956165487368893882691995190602880631120902600839879901410402130473430014611762807221135304553342661919905813892557985421081010298299577170493864109325857027362377773684094592728),
      SC_( 0.023528326419634282968940634170022516286172941428297178844349941764278844415048802692379906536590575481628082813309088490054210155246999133949139901871976304112317886154358758963603326096594545772597263),
      SC_( 0.022987493536995018501661023569698016556589382747929412484155241926528709206828142876263086633940494356695686923638996548464161480287561600147084736917947099136655365873125659991185803111197033603857404),
      SC_( 0.022470964611375183790917221916805454573118308367764123227956894819090692677902523041552342832287601794712215849258831259207963133180123583618159117083236355335002473311142188916805637821940835256749966),
      SC_( 0.021977137450881356630423394756311627412624481207270296067463067658596865517408695881058515671793774634218388688765004098714135972686296423124331956589409194841175312817315028422978477328113674762922805),
      SC_( 0.021504547658820865137039651845158508319996881963413963364249457072585523362399244085217305841926099775995326306912452113837009318622024211404105113489220158924351116219961531258517229691062635065380272),
      SC_( 0.021051854132338293837809230840178879528688597671879332309473540368194396155518302482682222093623700500304968679026530882510617286028090304658971568898907800391078142023492540765081285825059918904221377),
      SC_( 0.020617826354560516060031453062401101750910819894101554531695762590416618377740524704904444315845922722527190901248753104732839508250312526881193791121130022613300364245714762987303508047282141126443599),
      SC_( 0.020201333226697125805970645065733046773817941926588018505040202407159642117848812918148925781901732801660885195292901376286358875180758174528007618692975087169735183071204142412542991595803590522528564),

      /* From 500 to 1000 inclusive: */
      /* N[Table[polygamma(1,x),{x,500,1000,10}],200] */
      SC_( 0.0020020013333322666697142686477741970607311354966860615460410832605568029162770021807294240866895698623023373420446070125866901755206493873253364576640318733179549815884300997403750458609900493023003252),
      SC_( 0.0019627079077167794527075369878026278054784126631995776491306741676415067882820369679719316134485661193595818929270288755078893997403343189332867090027906046889888456807239954609144580624442590489664489),
      SC_( 0.0019249272208305600878368867511103577288174467430677354310509987086345986766935418482873744907080005476104236106265388133041544038092711240451959544956016546594392301468854156983794885279104025753001299),
      SC_( 0.0018885735652017974621762477149039828502280109878156886372740744819049209609207932934147994840594836342381339503927532780237308218400551267920556387313301036032181341525179992842551094845391685985377050),
      SC_( 0.0018535675879347174916423423155379091307013531526772231338072040017977771331889167164830799891352595724412309842177695515515563287038345399902550046782893550241707683207395928004610261174739769641971992),
      SC_( 0.0018198357124962072071488835448246890713250126055258369561325969805224321666164010587744106975053171872314724801892416134128202635982936613663431588979835606357076266627434704881260992866727748031105084),
      SC_( 0.0017873096225091129190492945303785243417271928459038380049046511646219355698972836782154466483214918948964497939844949575701443909852520249836415878529986159134770540827241344961191221519641465574880590),
      SC_( 0.0017559257999306889095255078737362103878067768177081572301679494304543821008467448811632719907386378052018224093307831371297830832956510628762420263939227669965033723542389185658774770798899659487028322),
      SC_( 0.0017256251110468222276959968507898198295726023961523021455159161627500746155238375891924725903653131572530281126938188449575453809964185474795155932435127309721684564140968120565240114861216146336251305),
      SC_( 0.0016963524346041752513119095336257147127430687494494002455571345098956413359748115916621365124986202597610934412973930519520359214647571237387033131225263924863926699728285925476075992079316779516936933),
      SC_( 0.0016680563271600651586008741718648462756431763480720903681207900114642810978435606979760116810550431815174575059359591857949523578791099729184045361656199107605783108403345996344500042395859969644990157),
      SC_( 0.0016406887213756970195080215970828459631479626636850934465156200325211943947124959128726396276064742449435894961655593101633559935109370637222775170775626241880356993958889518493844629967534469444739536),
      SC_( 0.0016142046535303445319081475266284062237444496261171355890900375193483941959697840921226143391315610528664405243695044741713985755277188786217322137955046182513377585676274405528091545807052423719153110),
      SC_( 0.0015885620170071333893501660104397118863341166886879426617760284126771899127326040301127509681447121721653530285382799130873075131640399728054671504560921879417722160074497026497015824921906049546581036),
      SC_( 0.0015637213389075671638498255507124748914923545316090559574220783761865104636574787820809503296433525455149916812345653568864611783611931453560552260618189461079074798779848976950758139385067606739753051),
      SC_( 0.0015396455773020947522495672074163453656958784173676963898722834049377118183152618530317195920313667233225978429255413222092986247964432893057756350900424285200703509880061708819317675923649556242896925),
      SC_( 0.0015162999369263925202032406171604265476393721382026916104370047548383517457880216007755593858832085611496132509405905912568838325690248464249814196631991129252785302552401751922685186794974337340654500),
      SC_( 0.0014936517013947606959535852364602864810179656294089699296286229753235203964894704150852745714262779754219802589421533654611393417351561019259987325767705767942456784700040095303531574766718391876496931),
      SC_( 0.0014716700802290943005782803560964466864767904581163275202176135700002220736612946331323727237480285915408996377958814353491579550187238310139782845354508056183654302615826496752495582635082326591654480),
      SC_( 0.0014503260691993115971531336704481602033869994873222490773242291344616119971618932239448097362194934701357501887276862450114838031880569044221735057596629997556744801142447913160983903036737438841171998),
      SC_( 0.0014295923226431447217345395336486592861436269862931956526331656383707489048302120662149489781693905507189450751284985371724620216826811891047926174942995820893454210388826064789648227906696120392470936),
      SC_( 0.0014094430365833979461769932677029841007332268324744758450765265718107919882589310932199259186320650909435517632168921689123779731483562781532997132857252065915457114116673258716396339985332477754313953),
      SC_( 0.0013898538415921916965227975554684108194435483811401026961452313391204365440261836477234882468005799039259962139176563535150015747141904515171039231334130865248934035463490142271747426409385495839778805),
      SC_( 0.0013708017044669104844466043238825261774197580009779209756406677661675338573699232977176049381834168403693865108817588895809397327898579378117252942495085973252549629234224383341434261801465306406629126),
      SC_( 0.0013522648378837526776883248969627489419038473398944476030444744030497283682090321312440860097885383457870369040661506249049931935815335994911012180286503826599986463181468974352239827976610008042539967),
      SC_( 0.0013342226172838101510700019511639036175039940655944252319974629396972255987360902001079246683555531833206667803020400285336640241422671164642151071064318138727193062700558337936233915007712463865592860),
      SC_( 0.0013166555043250860107919294914588144986706263713383859381709451076492929381258092306486466126138923367962954958413912229893030025987557793549566008275842120513147287575012686657798017160462974804099227),
      SC_( 0.0012995449763031597845039809655993195248184320649572384485647153323069759150367743700812338118059303547873711151571227948232040140343524692004048272029686149626502509633560055656989069452969538647662734),
      SC_( 0.0012828734610045092597116089080381699040795553074398274366912444189597139335147078254517063074878489150422324365077029407162219057173250328923255783594932788574081829836548579577237580599557219284099861),
      SC_( 0.0012666242765108100099256042986175910702361253703112800348629918812461937211652004640177717892521988942292657827220874672389477099915376158122252178889156278840808609443057002196581883057090919279911073),
      SC_( 0.0012507815755207316081864490750298917940960135107192622143049381921602592232834112911260212697875035696125943148811907061986542286382680105098417875826522012909214990158244505154353320504738807680889555),
      SC_( 0.0012353302937985888583277393843855816494402402361493285121690340664838234373469621442516033245804312992413585397935160912048530939626687745433585024375424976030488851720888223637882182285596744021720036),
      SC_( 0.0012202561023973409647510554413760219591253458128750740357922557951187196040710586349693366271601662012963549105563752229619469262309317440642492946287833012567247053165793423164458248929250878089782392),
      SC_( 0.0012055453633374285886186397433219443854307496662263232808297121921752827628468585672227550898138204687321134869489291061332951897094428849508193170016349995515027135347448198156884023011141424843148788),
      SC_( 0.0011911850884532910619732944668483462839718618944437088339824006308673502978015345650797133691119558213607016883279213977615422284444403490239276360676809757392875188499484779388742818518272036745895703),
      SC_( 0.0011771629011465426918148238932595880043095927430570749930388705571347163647619390088466123948192254004713789573322506707221485096331611252752227008689747094007487257795838613444149348843522362792168353),
      SC_( 0.0011634670008090822149359597196026563500210929137087167624286296169163311584771206634412372297608100949304488089225981846458933316877983508135308793652587950202616780912349434513584363686166376315763816),
      SC_( 0.0011500861297011898615878529659525228860825376352063303559347849432754010280137232877605072062547820276431424594316497698393236980315783312226281973379418546095832291012330381427282307435194768979896537),
      SC_( 0.0011370095420892180788487778026539329971019887486780966819276239071197444896921119777951570505929754231819170145836421129497323950970739103191277240479114945278681503097204249871418703464850710110491783),
      SC_( 0.0011242269754650553208381360392887945011312815110515159801496652979113711183444491644245516060566416292675291979316570961923044195755512756762943554148708858240575606438195461753338014892618340271719270),
      SC_( 0.0011117286236853573586276839399489645470621333169478560310362538205817755249534423599981446688196367323075570054477792710144581814549954365384441162723839152794425672951971517869206735416336559556692729),
      SC_( 0.0010995051118827906247903402689635605612122310390298623778959181284872961916406427648111225542930182498001777274477091778508480693384391440016355626920561582495044240485816241507391769654541470920903224),
      SC_( 0.0010875474730143873852136288070798181291889201939837921240187403397562417939135269918221835722999262314594356414172237015197788165621484124642615339788369212760479388588523444356930575512440742699608533),
      SC_( 0.0010758471259237230814147452582117212672072518757931543017366471338492570777766169939813466466724812849573013089384174649717581532928156735735118919406667621112463906369760815954825748610392963737368204),
      SC_( 0.0010643958548041244982285020568956697029105976297871770104427634005655064744130111414670338507432553955867206786225054804526114620481057096646833155395772027677804748347719771516070891493616968857406184),
      SC_( 0.0010531857899596206237113653840071693401534144538524801397944077733568496308738043906004900724043517762862531781959900653597551663868158002681337625035180663023292064542073351179877406416856204787568651),
      SC_( 0.0010422093897689598905359541121252691543137118949485325004094064690087832058333594962134231229304805292550807520155650822933820490617336537741485540981701681319667624543774684994529527935593164542621168),
      SC_( 0.0010314594237658298641684279869660019577016673547394474797863100707371029081023552464490030330732745171871699843037817166928714049976639478339435326167370746473630150031942266061407084489143079970207392),
      SC_( 0.0010209289567555099904502214400268077213402819772588698542275898078257650933420596641660231700681791622794498713241853817043206395034463901536314238812897593734838523012915239563700129244318304902335783),
      SC_( 0.0010106113338946372783610336547559618045431800080944987312821099163252919497467378644143815050581245498506383967247638482792976460918206345972550561270749449496960077963485519847107615612450600269733429),
      SC_( 0.0010005001666666333333571428238095995668464547131131210183210239418927651895637193471912624961639912199795499793319598809347037539489491064986468025967580606481483505743605024974387253961044557355571459)
   };

   static const unsigned index[] =
   {
      1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50,
      500, 510, 520, 530, 540, 550, 560, 570, 580, 590, 600, 610, 620, 630, 640, 650, 660, 670, 680, 690, 700, 710, 720, 730, 740, 750, 760, 770, 780, 790, 800, 810, 820, 830, 840, 850, 860, 870, 880, 890, 900, 910, 920, 930, 940, 950, 960, 970, 980, 990, 1000
   };

   static const unsigned table_size = sizeof(index) / sizeof(index[0]);

   T tol = boost::math::tools::epsilon<T>() * 10;
   for(unsigned i = 1; i < table_size; ++i)
   {
      T x(index[i]);
      T b2n = boost::math::trigamma(x);
      BOOST_CHECK_CLOSE_FRACTION(b2n, static_cast<T>(data[i]), tol);
   }

   std::cout<<typeid(T).name()<<std::endl;
}

template <class T>
void test_near_zero()
{

   static const char *index_near_zero[]=
   {
      SC_( 0.01), SC_( 0.02), SC_( 0.03), SC_( 0.04), SC_( 0.05), SC_( 0.06), SC_( 0.07), SC_( 0.08), SC_( 0.09), SC_( 0.1), SC_( 0.11), SC_( 0.12),
      SC_( 0.13), SC_( 0.14), SC_( 0.15), SC_( 0.16), SC_( 0.17), SC_( 0.18), SC_( 0.19), SC_( 0.2), SC_( 0.21), SC_( 0.22), SC_( 0.23), SC_( 0.24),
      SC_( 0.25), SC_( 0.26), SC_( 0.27), SC_( 0.28), SC_( 0.29), SC_( 0.3), SC_( 0.31), SC_( 0.32), SC_( 0.33), SC_( 0.34), SC_( 0.35), SC_( 0.36),
      SC_( 0.37), SC_( 0.38), SC_( 0.39), SC_( 0.4), SC_( 0.41), SC_( 0.42), SC_( 0.43), SC_( 0.44), SC_( 0.45), SC_( 0.46), SC_( 0.47), SC_( 0.48),
      SC_( 0.49), SC_( 0.5)
   };

   static const char *data_near_zero[]=
   {
       /* From 0.01 to 0.50 inclusive: */
      /* [Table[N[polygamma(1,x),200],{x, 10 ^-2, 2^-1 , 10^-2}] */
      SC_( 10001.621213528313220123356448206019391412013926961399000282915705233712354437409079458434446066066876040951276360433905387904873852390140775054777396130986037002813656661538121672903358761600115617912),
      SC_( 2501.5981181918680666113909455338722482043069124654995615933470154371406625694287353164894776816301830278448266787796691291127115725981530680204950910942131330657309050060424355996629187616756003661077),
      SC_( 1112.6867360264795183713028853718416248407981652006317327364909790858994237952650134479074937708991089491733777033745994169998724596868554111488130577219415523426976177137848867097987265226925819035944),
      SC_( 626.55371164260543542202870921931502385977584873785692497361191887346237630495333264109858812893010667871690685249278732497278882368196899678687571338295279626762010681523454566541969902468824246199644),
      SC_( 401.53235734211511930849147858824636794074961442906165203171013545894849451543545643432648291475460168447497286274899876700762009616559122891429147773765923031701409312276456759133436093391924458961655),
      SC_( 279.28931972776886673825394359450591136735240984541112525814571365136675006261325757364801602450717626400223712082017684308190344365838206635800652537735519198093428788112864878017084494709985442593906),
      SC_( 205.57287896946515109170808230331758989324814679479995467779397133333857248290570903725094478168029723737396869465787150715507899477506811781256346555283534054811457035203033966522686433397527074416640),
      SC_( 157.72145215555422749748749315671739294102998330083364465781578835595344499412565187141754783576705080668301863728680496666467557594009762941641617566971813316028870631018668376389230899449097888623129),
      SC_( 124.90893212226596876275752186095978827288313056189069439874144745063057831775110724204324639344242094464225104170223568268113953764171536190216029445008712023576646591993055191419173674256546506349713),
      SC_( 101.43329915079275881721545010641733626263244134115550248397927198176432175540920075570400539335078471216749004994532249740032162354975654081744265835277623361280368265604362391582059034229441759685969),
      SC_( 84.059535747391749196957244383968846055449874338475924482716956960557153732479951455195006014587137533319292754556218390097070486721367648372197848484952792761087159224295553262847284301708162051158812),
      SC_( 70.841396665712644003513415420196154740751279353180710696633720397773876782342496932402841602980692890764719998657235779564647490456515557373618690322288958645514878497178183475178553761087862246587413),
      SC_( 60.551015890479993333836202084958222398390292852196165748736560081539355422228384525207715929626817025233344611840428715983978005317448609187753241943052284874013494054442706767461976628727369553533115),
      SC_( 52.382699930282750353464838432902093379966480450870349482888680452664591145938462821808736517410462830588181009551633407174973554634966796507854623438659589591476290004599722833435414487680714844146275),
      SC_( 45.790003796480552327569711559358304883301496119449600569405276782820233021273858056401114150300336927259566366370426842796547607913006083430311483083141091476358986897170815522318489417070075754701720),
      SC_( 40.391708175237420114687763449022396325414718565569412235825682854791797687429918521916582713357701701220073911583874980185133388429516720903512895501440432327601325124720497021166828926849600597646354),
      SC_( 35.915302056813118952327467341551268613061566595863926322083106330093567509817220610368354146861285163667208399429486549794941663000709844585358047793562617577344611671082510322783975182318742229123520),
      SC_( 32.161798355693915686280591882282181330666505895552128366146637195298999330172013813876370284669401886627812620731262308421980966686380202150313549028901505895933579984874442932323464827454867346511379),
      SC_( 28.983152560742538299107372095236734825773809590236869666245199731897509840836732316233420067430639871920598759181506930743089455815833507761249725016555626705909920025906643917788005830220105453672354),
      SC_( 26.267377205423779123302466215031907888389883990800409384456638738635473050907420409972929295303223315722178641345109468601410036415345721441966068895459754094465626840378644716069061117921402783016906),
      SC_( 23.928494370468169504682229904002308664388811549145871494173356001976539795974607962005170666024202159108341044706246132584214135334047347759083818115918261620786492105686806777862232555930092882512582),
      SC_( 21.899609160829679132295481452651144302056010198774091059697486725822439298007713365026102656135942203367082591442881131600410001064304477987484636316192440483394613701766545360009431291803478819083303),
      SC_( 20.128043452598280281864165894853367721467708565388001100181823513071998745818198584892156423649835614771876164875386092707049613795772245336745018131106297700468701151416476274327113056380178806184471),
      SC_( 18.571858181768829714571072305054936985031398567336047589046068810176536447725198916357490151118014176688023495666346178715647891993530985269278620725642021993048276493193133493920450402346095914022379),
      SC_( 17.197329154507110739271319119335224021506894401494167700545334333194148980629243398836625507127473081812621294727592740710059538548636919203063375577834464916953056086393131314723815861058153031708142),
      SC_( 15.977088888138623392171697356960892848909742821098294027743686814636171333067497078447745553575857545872163920748643883384955737070502546913051774454792557190944815096097077588557212221974016015549529),
      SC_( 14.888740954936531070762472110860696804576253657881800264415512711840706467117224301429514838273686781230584602714208545598745747757943081678099656941915638073969978479380729474721002998616061527565021),
      SC_( 13.913814339811878712634773088679135590038515100129040544228388500811925753468351070575429413056107708120260296825840026109633004083246623817074400782822015477803757011873612595409095810217421376014414),
      SC_( 13.036965697335936694248628905532831533016883482058161107346268052373773822487444055275188518996740091502517282871903624372247007841236869981560777645137588566497323037732516136368005811155331914868258),
      SC_( 12.245364546107730465473603533088736435717782766341532547742604350234695143471145864678047559182382999649052690011551240903057861774730416055297398085386213727424343318729336305281272932772546664637182),
      SC_( 11.528214980739199776432238102907780004889684779675078630255627145418426617093680437524670630466257703291843276841372223541510133531773184200317228196644552046000658285992748671689198248807442587604076),
      SC_( 10.876380324575851735881282103366356522667166254392919025699994498395913108549968926004408917178733692669205004854258158762201252065033191136389383067933980630015978723821441412931168851034700353121090),
      SC_( 10.282086159138309087191765628595602018545680985778598504131634646160784457179466390424698379057023869173580536531617638978942911779336631394483393691059588800564532402165678070439834488833080557713499),
      SC_( 9.7386835690812960500636329444719021568563570529300730065783877309629395633209860638693341747700367031470606796431632208114640785987741449393730576819174347406312996476293597406921679600441075023972919),
      SC_( 9.2404590422058116966600168222999728285587581897744443846187993845919323373198923241047210244547988382948709031538582026395462187015469042283342428142167954570963960904997223516849779267426049667639589),
      SC_( 8.7824808053341432587364135115504992160750656393701376531488154764574405821299484205875736289424779784800625189467140313861202936079808430843097958513241028920230111244927280298440274248068637629765564),
      SC_( 8.3604738277990979087382862942835857580416057390043383410751553369586078232231160430261776582519291220073703698431000564783637820847879105467696121035745609202169196611545833198447734877446124366315756),
      SC_( 7.9707175390874539106438938172742016010804343072774111279853921446221774935618410805573916782122258803224893432149420899687774951094792996058770068516703367308182590553942920589851931540088581488094515),
      SC_( 7.6099616628369674753733490624531721315452277640935314268707583935315146881850260347587989942801917556204968202061270112191179734352231147246226575732271575385680487448315940003291864765787728045849169),
      SC_( 7.2753565905295974375370275490099566339472232942736103997029482525915491411381420057736529394428258576168551265869574635861446072893731567716657137565533364516261923758222193692199653328265375207040720),
      SC_( 6.9643954934581261093723480723151744969558808743971492516447430689802157758123069382292461513181350710080138931782880007465787223410819858520190902902875248685486321027339798250791980205665099644108338),
      SC_( 6.6748659644753435795132182899949814619906424042600980364872428342761386460454745620899198724349904420857322882497146087049423428368019868192084031261412287953493467699297976554664544938636570402745858),
      SC_( 6.4048094377358710730674561452007634805527459657928130724553838855224385508212732506654238359109570506351903250555257621751796138348353076340799919592391210067567605540280250352779721681867159474606269),
      SC_( 6.1524869887661151042910042184059274070736029203878333755169961205046892220019038213478102180864906297339863671376644664047189806267248194242249287616083738332309912533871941866669982407655172203103435),
      SC_( 5.9163503935325380889729186010706659548089377054801586870109302172615717497949616070594443444580355870051972601804255488849976375487385328178985251631665928654606920117828455716723944906599330350982688),
      SC_( 5.6950175421148027968393542389688148225499297482877984243682376027447726664582755218813952102217048280997811114024097365581723516463613887159814964625719873151724960978062151159557004127230988739472311),
      SC_( 5.4872514738768636709368641519714033166836829118590862194017546604379891185903986393679448504213516022537276724151707181599548831683580891144582398659829889284100733959842886260370465896537313949005783),
      SC_( 5.2919424370143186313867820668447890239540131107695269654304832433179752021900727617447985532187349697719951026515326708103072837813642770971865387541700903990090449218493681051050882928494605509201512),
      SC_( 5.1080924838814033369655631231243504470314680418045499730467964430628461051756046948184375014485627928110565928274646987701995676987543977109122407095193304486698542122182293763690010883851470995990816),
      SC_( 4.9348022005446793094172454999380755676568497036203953132066746881100224112096026215008867018592761159120129568870115720388861740610150233638053088389925988304951999281032878152857530206164201643904347)
   };

   static const unsigned table_size_near_zero = sizeof(index_near_zero) / sizeof(index_near_zero[0]);

   T tol = boost::math::tools::epsilon<T>() * 10;

   for(unsigned i = 1; i < table_size_near_zero; ++i)
   {
      T x(index_near_zero[i]);
      T b2n = boost::math::trigamma(x);
      BOOST_CHECK_CLOSE_FRACTION(b2n, static_cast<T>(data_near_zero[i]), tol);
   }

   std::cout<<typeid(T).name()<<std::endl;

}

BOOST_AUTO_TEST_CASE( test_main )
{
   using namespace boost::multiprecision;
   test<number<mpfr_float_backend<50>, et_off> >();
   test<number<mpfr_float_backend<100>, et_off> >();
   test<number<mpfr_float_backend<200>, et_off> >();
}

BOOST_AUTO_TEST_CASE( test_main_near_zero )
{
   using namespace boost::multiprecision;
   test_near_zero<number<mpfr_float_backend<50>, et_off> >();
   test_near_zero<number<mpfr_float_backend<100>, et_off> >();
   test_near_zero<number<mpfr_float_backend<200>, et_off> >();
}



